Zobs_long = rep(0,nrow(network)) # need to make a long Z
hotspot_indices = match(names(Zobs),rownames(network)) # indices in network dataframe that correspond to hotspot indices
Zobs_long[hotspot_indices] <- Zobs
plot(network,xlab='',ylab='',pch=19,cex=0.4,col=rgb(0.5,0.5,0.5,alpha=0.5),xaxt='n',yaxt='n',bty='n')
points(network[hotspot_indices,],col='blue',pch=19,cex=0.6)
points(network[which(Zobs_long==1),],col='green',pch=8,cex=0.75)
# What about another, alternative treatment?  Let's write a function
# This function will take in a small Z and output a long Z
treatmentlong = function(Zalt,network,hotspot_indices){
Zalt
Zalt_long = rep(0,nrow(network))
Zalt_long[hotspot_indices] <- Zalt
return(Zalt_long)
}
# A second function that uses the one above for plotting
plottreatment = function(Zalt,network,hotspot_indices){
Zalt_long = treatmentlong(Zalt,network,hotspot_indices)
plot(network,xlab='',ylab='',pch=19,cex=0.4,col=rgb(0.5,0.5,0.5,alpha=0.5),xaxt='n',yaxt='n',bty='n')
points(network[hotspot_indices,],col='blue',pch=19,cex=0.6)
points(network[which(Zalt_long==1),],col='green',pch=8,cex=0.75)
}
DiM_function = function(Y,Zalt){
DiM = mean(Y[which(Zalt==1)]) - mean(Y[which(Zalt==0)])
return(DiM)
}
DiM_function = function(Zalt,Y){
DiM = mean(Y[which(Zalt==1)]) - mean(Y[which(Zalt==0)])
return(DiM)
}
DiM_observed = DiM_function(Z[,1],Y)
#' In this script, we investigate a policing experiment and see how to use the
#' FRT to characterize statistical uncertainty in the DiM estimator of the SATE
# First, load in all of the data
load('../data/Z_police.RData') # treatment assignments
load('../data/network_police.RData') # network
load('../data/outcomes_police.RData') # outcomes of interest
# convert to data frames and reorder rows
network = as.data.frame(network)
network = network[order(as.numeric(rownames(network))),]
outcomes = as.data.frame(outcomes)
outcomes = outcomes[order(as.numeric(rownames(outcomes))),]
Z = as.data.frame(Z)
# Let's plot our data first, what are we looking at?
head(network)
plot(network,xlab='',ylab='',pch=19,cex=0.4,col=rgb(0.5,0.5,0.5,alpha=0.5),xaxt='n',yaxt='n',bty='n')
# What do our outcomes look like?  Let's create a "crime index"
head(outcomes)
Y = (outcomes$hmotos +  outcomes$hcarros)*0.221 +
outcomes$homicidio*0.550 + outcomes$lesiones*0.112 +
outcomes$hpersonas*0.116
names(Y) = rownames(outcomes)
points(network,col=rgb(1,0,0,alpha=0.5),cex=Y,pch=19)
# Let's plot the observed treatment
dim(Z)
Zobs = Z[,1]; names(Zobs) = rownames(Z)
Zobs_long = rep(0,nrow(network)) # need to make a long Z
hotspot_indices = match(names(Zobs),rownames(network)) # indices in network dataframe that correspond to hotspot indices
Zobs_long[hotspot_indices] <- Zobs
plot(network,xlab='',ylab='',pch=19,cex=0.4,col=rgb(0.5,0.5,0.5,alpha=0.5),xaxt='n',yaxt='n',bty='n')
points(network[hotspot_indices,],col='blue',pch=19,cex=0.6)
points(network[which(Zobs_long==1),],col='green',pch=8,cex=0.75)
# What about another, alternative treatment?  Let's write a function
# This function will take in a small Z and output a long Z
treatmentlong = function(Zalt,network,hotspot_indices){
Zalt
Zalt_long = rep(0,nrow(network))
Zalt_long[hotspot_indices] <- Zalt
return(Zalt_long)
}
# A second function that uses the one above for plotting
plottreatment = function(Zalt,network,hotspot_indices){
Zalt_long = treatmentlong(Zalt,network,hotspot_indices)
plot(network,xlab='',ylab='',pch=19,cex=0.4,col=rgb(0.5,0.5,0.5,alpha=0.5),xaxt='n',yaxt='n',bty='n')
points(network[hotspot_indices,],col='blue',pch=19,cex=0.6)
points(network[which(Zalt_long==1),],col='green',pch=8,cex=0.75)
}
# bringing it all together
plottreatment(Z[,1],network,hotspot_indices)
plottreatment(Z[,2],network,hotspot_indices)
plottreatment(Z[,3],network,hotspot_indices)
plottreatment(Z[,4],network,hotspot_indices)
plottreatment(Z[,5],network,hotspot_indices)
# Now, let's look into estimating some causal effects
# Since randomization is done only on the hotspots, we restrict our outcome vector to just the hotspots
Yobs = Y[hotspot_indices]
# Now, let's look into estimating some causal effects
# Since randomization is done only on the hotspots, we restrict our outcome vector to just the hotspots
Yobs = Y[hotspot_indices]
DiM = mean(Yobs[which(Zobs==1)]) - mean(Yobs[which(Zobs==0)])
DiM_function = function(Zalt,Y){
DiM = mean(Y[which(Zalt==1)]) - mean(Y[which(Zalt==0)])
return(DiM)
}
DiM_observed = DiM_function(Z[,1],Y)
DiM_observed = DiM_function(Z[,1],Yobs)
ncol(Z[,-1])
# calculate alternative DiM in a for loop
DiM_alt = c()
for(i in 1:ncol(Z[,-1])){
DiM_alt = c(DiM_alt,DiM_function(Z[,i],Yobs))
}
DiM_alt
hist(DiM_alt)
mean(DiM_observed<DiM_alt)
mean(DiM_alt<DiM_observed)
DiM_alt = apply(Z[,-1],2,DiM_function,Yobs=Yobs)
DiM_alt = apply(Z[,-1],2,DiM_function,Y=Yobs)
# calculate alternative DiM's in a for loop
DiM_alt = c()
for(i in 1:ncol(Z[,-1])){
DiM_alt = c(DiM_alt,DiM_function(Z[,i+1],Yobs))
}
DiM_alt = apply(Z[,-1],2,DiM_function,Y=Yobs)
DiM_alt = apply(Z[,-1],2,DiM_function,Y=Yobs)
# calculate alternative DiM's in a for loop
DiM_alt = c()
for(i in 1:ncol(Z[,-1])){
DiM_alt = c(DiM_alt,DiM_function(Z[,i+1],Yobs))
}
tobs = -0.015
sd(DiM_alt)
set.seed(2)
tobs = -0.015
trand1 = rnorm(1,0,sd=0.025)
hist(c())
hist(tobs)
hist(tobs,col='white')
hist(tobs,col='white',bty='n')
hist(tobs,col='white',bty='n',lty='blank')
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.05,0.05))
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.05,0.05),main='',xlab='difference-in-means')
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.05,0.05),main='',xlab='difference-in-means',freq=FALSE)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.05,0.05),main='',xlab='difference-in-means')
abline(v=tobs,col='blue',lwd=3)
abline(v=tobs,col='blue',lwd=4)
hist(c(tobs,trand1),col='white',bty='n',lty='blank',xlim=c(-0.05,0.05),main='',xlab='difference-in-means')
hist(c(tobs,trand1),col='gray',bty='n',lty='blank',xlim=c(-0.05,0.05),main='',xlab='difference-in-means')
abline(v=tobs,col='blue',lwd=4)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.05,0.05),main='',xlab='difference-in-means',yaxt='n')
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.05,0.05),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
abline(v=rnorm(1,0,sd=0.025),col='gray',lwd=4)
abline(v=rnorm(1,0,sd=0.025),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
hist(c(tobs,trand1),col='gray',bty='n',lty='blank',xlim=c(-0.05,0.05),main='',xlab='difference-in-means')
abline(v=tobs,col='blue',lwd=4)
pdf(file='tobs.pdf')
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.05,0.05),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
setwd("~/Dropbox/SalemCenter/classes/PRL/classes/lecture-causality/code")
pdf(file='tobs.pdf',height=5,width=6)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.05,0.05),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
pdf(file='tobs.pdf',height=5,width=6)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.055,0.055),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
pdf(file='tobs.pdf',height=5,width=6)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.06,0.06),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
# just making some FRT slides
set.seed(2)
tobs = -0.015
pdf(file='tobs.pdf',height=5,width=6)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.06,0.06),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
for(i in 1:20){
pdf(file=paste('tobs',i,'.pdf'),height=5,width=6)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.06,0.06),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
abline(v=rnorm(1,0,sd=0.025),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
dev.off()
}
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.06,0.06),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
abline(v=rnorm(1,0,sd=0.025),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
abline(v=c(rnorm(1,0,sd=0.025),rnorm(1,0,sd=0.025)),col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
# just making some FRT slides
set.seed(2)
tobs = -0.015
pdf(file='tobs.pdf',height=5,width=6)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.06,0.06),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
trand = c()
for(i in 1:20){
trand=c(trand,rnorm(1,0,sd=0.025))
pdf(file=paste('tobs',i,'.pdf'),height=5,width=6)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.06,0.06),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
abline(v=trand,col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
dev.off()
}
trand = c()
for(i in 1:1000){
trand=c(trand,rnorm(1,0,sd=0.025))
}
hist(trand,col='gray',bty='n',lty='blank',xlim=c(-0.05,0.05),main='',xlab='difference-in-means')
hist(trand,col='gray',bty='n',lty='blank',xlim=c(-0.06,0.06),main='',xlab='difference-in-means')
# just making some FRT slides
set.seed(2)
tobs = -0.015
pdf(file='tobs.pdf',height=5,width=6)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.07,0.07),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
trand = c()
for(i in 1:20){
trand=c(trand,rnorm(1,0,sd=0.025))
pdf(file=paste('tobs',i,'.pdf'),height=5,width=6)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.07,0.07),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
abline(v=trand,col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
dev.off()
}
# just making some FRT slides
set.seed(2)
tobs = -0.015
pdf(file='tobs.pdf',height=5,width=6)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
trand = c()
for(i in 1:20){
trand=c(trand,rnorm(1,0,sd=0.025))
pdf(file=paste('tobs',i,'.pdf',sep=''),height=5,width=6)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
abline(v=trand,col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
dev.off()
}
# just making some FRT slides
set.seed(2)
tobs = -0.015
pdf(file='tobs.pdf',height=5,width=7)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
trand = c()
for(i in 1:20){
trand=c(trand,rnorm(1,0,sd=0.025))
pdf(file=paste('tobs',i,'.pdf',sep=''),height=5,width=7)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
abline(v=trand,col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
dev.off()
}
# just making some FRT slides
set.seed(2)
tobs = -0.015
pdf(file='tobs.pdf',height=5,width=5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
trand = c()
for(i in 1:20){
trand=c(trand,rnorm(1,0,sd=0.025))
pdf(file=paste('tobs',i,'.pdf',sep=''),height=5,width=5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
abline(v=trand,col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
dev.off()
}
# just making some FRT slides
set.seed(2)
tobs = -0.015
pdf(file='tobs.pdf',height=3,width=5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
trand = c()
for(i in 1:20){
trand=c(trand,rnorm(1,0,sd=0.025))
pdf(file=paste('tobs',i,'.pdf',sep=''),height=3,width=5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
abline(v=trand,col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
dev.off()
}
# just making some FRT slides
set.seed(2)
tobs = -0.015
pdf(file='tobs.pdf',height=4,width=5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
trand = c()
for(i in 1:20){
trand=c(trand,rnorm(1,0,sd=0.025))
pdf(file=paste('tobs',i,'.pdf',sep=''),height=4,width=5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
abline(v=trand,col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
dev.off()
}
hist(trand,col='gray',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means')
abline(v=tobs,col='blue',lwd=4)
hist(trand,col='gray',bty='n',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',breaks=20)
trand = c()
for(i in 1:1000){
trand=c(trand,rnorm(1,0,sd=0.025))
}
hist(trand,col='gray',bty='n',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',breaks=20)
abline(v=tobs,col='blue',lwd=4)
hist(trand,col='gray',bty='n',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',breaks=40)
hist(trand,col='gray',bty='n',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',breaks=30)
hist(trand,col='gray',bty='n',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',breaks=25)
hist(trand,col='gray',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',breaks=20)
trand = c()
for(i in 1:2000){
trand=c(trand,rnorm(1,0,sd=0.025))
}
hist(trand,col='gray',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',breaks=20)
abline(v=tobs,col='blue',lwd=4)
hist(trand,col='gray',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',breaks=40)
# just making some FRT slides
set.seed(2)
tobs = -0.015
pdf(file='tobs.pdf',height=4,width=5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
trand = c()
for(i in 1:20){
trand=c(trand,rnorm(1,0,sd=0.025))
pdf(file=paste('tobs',i,'.pdf',sep=''),height=4,width=5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
abline(v=trand,col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
dev.off()
}
trand = c()
for(i in 1:5000){
trand=c(trand,rnorm(1,0,sd=0.025))
}
pdf(file=paste('trandandtobs',i,'.pdf',sep=''),height=4,width=5)
hist(trand,col='gray',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',breaks=40)
abline(v=tobs,col='blue',lwd=4)
dev.off()
# just making some FRT slides
set.seed(2)
tobs = -0.015
pdf(file='tobs.pdf',height=4,width=5.5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
dev.off()
trand = c()
for(i in 1:20){
trand=c(trand,rnorm(1,0,sd=0.025))
pdf(file=paste('tobs',i,'.pdf',sep=''),height=4,width=5.5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',yaxt='n',ylab='')
abline(v=tobs,col='blue',lwd=4)
abline(v=trand,col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
dev.off()
}
trand = c()
for(i in 1:5000){
trand=c(trand,rnorm(1,0,sd=0.025))
}
pdf(file=paste('trandandtobs',i,'.pdf',sep=''),height=4,width=5.5)
hist(trand,col='gray',bty='n',lty='blank',xlim=c(-0.08,0.08),main='',xlab='difference-in-means',breaks=40)
abline(v=tobs,col='blue',lwd=4)
dev.off()
?seq
seq(-0.075,0.075,by=0.025)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.075,0.075),main='',xlab='difference-in-means',yaxt='n',ylab='',xaxt='n')
abline(v=tobs,col='blue',lwd=4)
axis(1, at=seq(-0.075,0.075,by=0.025), labels=seq(-0.075,0.075,by=0.025), lwd.ticks=0)
axis(1, at=seq(-0.075,0.075,by=0.025), labels=seq(-0.075,0.075,by=0.025))
seq(-0.075,0.075,by=0.025)
axis(1, at=seq(-0.075,0.075,by=0.025), labels=round(seq(-0.075,0.075,by=0.025),3))
# just making some FRT slides
set.seed(2)
tobs = -0.015
pdf(file='tobs.pdf',height=4,width=5.5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.075,0.075),main='',xlab='difference-in-means',yaxt='n',ylab='',xaxt='n')
abline(v=tobs,col='blue',lwd=4)
axis(1, at=seq(-0.075,0.075,by=0.025), labels=round(seq(-0.075,0.075,by=0.025),3))
dev.off()
trand = c()
for(i in 1:20){
trand=c(trand,rnorm(1,0,sd=0.025))
pdf(file=paste('tobs',i,'.pdf',sep=''),height=4,width=5.5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.075,0.075),main='',xlab='difference-in-means',yaxt='n',ylab='',xaxt='n')
abline(v=tobs,col='blue',lwd=4)
abline(v=trand,col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
axis(1, at=seq(-0.075,0.075,by=0.025), labels=round(seq(-0.075,0.075,by=0.025),3))
dev.off()
}
trand = c()
for(i in 1:5000){
trand=c(trand,rnorm(1,0,sd=0.025))
}
pdf(file=paste('trandandtobs',i,'.pdf',sep=''),height=4,width=5.5)
hist(trand,col='gray',bty='n',lty='blank',xlim=c(-0.075,0.075),main='',xlab='difference-in-means',breaks=40,xaxt='n')
abline(v=tobs,col='blue',lwd=4)
axis(1, at=seq(-0.075,0.075,by=0.025), labels=round(seq(-0.075,0.075,by=0.025),3))
dev.off()
# just making some FRT slides
set.seed(2)
tobs = -0.015
pdf(file='tobs.pdf',height=5,width=5.5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.075,0.075),main='',xlab='difference-in-means',yaxt='n',ylab='',xaxt='n')
abline(v=tobs,col='blue',lwd=4)
axis(1, at=seq(-0.075,0.075,by=0.025), labels=round(seq(-0.075,0.075,by=0.025),3))
dev.off()
trand = c()
for(i in 1:20){
trand=c(trand,rnorm(1,0,sd=0.025))
pdf(file=paste('tobs',i,'.pdf',sep=''),height=5,width=5.5)
hist(tobs,col='white',bty='n',lty='blank',xlim=c(-0.075,0.075),main='',xlab='difference-in-means',yaxt='n',ylab='',xaxt='n')
abline(v=tobs,col='blue',lwd=4)
abline(v=trand,col=rgb(0.5,0.5,0.5,alpha=0.8),lwd=4)
axis(1, at=seq(-0.075,0.075,by=0.025), labels=round(seq(-0.075,0.075,by=0.025),3))
dev.off()
}
trand = c()
for(i in 1:5000){
trand=c(trand,rnorm(1,0,sd=0.025))
}
pdf(file=paste('trandandtobs',i,'.pdf',sep=''),height=5,width=5.5)
hist(trand,col='gray',bty='n',lty='blank',xlim=c(-0.075,0.075),main='',xlab='difference-in-means',breaks=40,xaxt='n')
abline(v=tobs,col='blue',lwd=4)
axis(1, at=seq(-0.075,0.075,by=0.025), labels=round(seq(-0.075,0.075,by=0.025),3))
dev.off()
dev.off()
setwd("~/Dropbox/SalemCenter/classes/PRL/Policy-Research-Laboratory/code")
#' In this script, we investigate a policing experiment and see how to use the
#' FRT to characterize statistical uncertainty in the DiM estimator of the SATE
# First, load in all of the data
load('../data/Z_police.RData') # treatment assignments
load('../data/network_police.RData') # network
load('../data/outcomes_police.RData') # outcomes of interest
# convert to data frames and reorder rows
network = as.data.frame(network)
network = network[order(as.numeric(rownames(network))),]
outcomes = as.data.frame(outcomes)
outcomes = outcomes[order(as.numeric(rownames(outcomes))),]
Z = as.data.frame(Z)
# Let's plot our data first, what are we looking at?
head(network)
plot(network,xlab='',ylab='',pch=19,cex=0.4,col=rgb(0.5,0.5,0.5,alpha=0.5),xaxt='n',yaxt='n',bty='n')
